### Backlog do Produto (Atualizado)

| Épico | ID | História de Usuário / Tarefa Técnica | Critérios de Aceitação | Prioridade |
| :--- | :--- | :--- | :--- | :--- |
| Dashboard (MVP) | US01 | Como Maria, eu quero ver os KPIs principais (Faturamento, Vendas, Ticket Médio). | • Métricas corretas (`invoicing`, `avg_ticket`).<br>• Design implementado com `<Card>` do Shadcn/UI.<br>• Formatação de moeda (ex: R$) aplicada. | P0 |
| Dashboard (MVP) | US02 | Como Maria, eu quero um seletor de período de datas global. | • Filtro de data implementado com presets ("Diário", "Semanal", "Mensal") e personalizado.<br>• Implementado como um filtro local em cada página. | P0 |
| Dashboard (MVP) | US03 | Como Maria, eu quero ver um ranking de "Top 10 Produtos Mais Vendidos". | • Ranking implementado na `Home`.<br>• Usa `<Table>` do Shadcn/UI.<br>• Lógica de `JOIN` (`sales` -\> `product_sales` -\> `products`) funcionando. | P0 |
| Dashboard (MVP) | US04 | Como Maria, eu quero um filtro de Lojas global. | • Filtro de Loja e Cidade implementado.<br>• Botão "Limpar" funcional.<br>• Implementado como um filtro local em cada página. | P0 |
| Exploração Flexível | US05 | Como Maria, eu quero poder exportar meu dashboard ou um gráfico (ex: PDF/CSV). | • (Implementação pendente) | P2 |
| Exploração Flexível | US06 | Como Maria, eu quero poder ver vendas por Dia da Semana e Hora do Dia. | • Dimensões `hourOfDay` e `dayOfWeek` criadas no Cube.js.<br>• Gráficos `<BarChart>` (recharts) implementados na `Home` e `/operacional`. | P1 |
| Exploração Flexível | US07 | Como Maria, eu quero uma **tela dedicada** (`/operacional`) para métricas de entrega. | • Página `app/operacional/page.tsx` criada e funcional.<br>• KPIs de Preparo e Entrega implementados.<br>• Ranking de Piores Bairros e Gráficos de Tempo (com granularidade) implementados. | P1 |
| Exploração Flexível | US08 | Como Maria, eu quero poder **criar minha própria análise** (Tela `/explorar`). | • Página `app/explorar/page.tsx` criada e funcional.<br>• Seletores (hardcoded) de Métrica e Dimensão funcionando.<br>• Gráfico de barras dinâmico implementado. | P1 |
| Análises Avançadas | US09 | Como Maria, eu quero ver um ranking de itens/complementos. | • `JOIN` complexo (`sales` -\> ... -\> `items`) implementado.<br>• Métricas (`revenue`, `times_added`) criadas.<br>• Ranking "Top 10 Itens" implementado na `Home`. | P1 |
| Análises Avançadas | US10 | Como Maria, eu quero um relatório de Taxa de Cancelamento e motivos. | • Métricas `cancellation_rate` e `count_cancelled` criadas.<br>• Gráfico "Taxa de Cancelamento por Canal" implementado na `/operacional`.<br> | P1 |
| Análises Avançadas | US11 | Como Maria, eu quero uma **tela dedicada** (`/clientes`) com um relatório de RFM. | • Página `app/clientes/page.tsx` criada e funcional.<br>• Métricas de RFM (`frequency`, `days_since_last_purchase`, `ltv`) implementadas.<br>• KPIs "Novos vs. Recorrentes" e Gráfico de "Faixa Etária" implementados. | P1 |
| Análises Avançadas | US12 | Como Maria, eu quero um gráfico de **anomalias** (Picos e Quedas). | • Gráfico `<LineChart>` (Faturamento por Dia) implementado na `Home`, que permite a identificação visual de anomalias. | P1 |
| Análises Avançadas | US13 | Como Maria, eu quero uma **tela dedicada** (`/lojas`) para comparar lojas. | • Página `app/lojas/page.tsx` criada e funcional.<br>• Gráfico "Próprias vs. Franqueadas" implementado.<br>• Lógica de "Top 5"s (Faturamento, Cancelamento, Crescimento) implementada.<br>• Lógica de "Ampliar" (link para `/lojas/tabela-completa`) implementada.<br>• Tabela completa com ordenação implementada. | P1 |
| Análises Avançadas | US14 | Como Maria, eu quero uma **tela dedicada** (`/produtos`). | • Página criada na `Sidebar`.<br>• Implementação funcionale fornecendo insights visuais | P2 |
| Análises Avançadas | US15 | Como Maria, eu quero fazer uma **Análise de Descontos**. | • (Implementação pendente)<br>• (Ex: Criar métrica `total_discount`). | P2 |
| Qualidade Técnica | T01 | [Técnico] Configurar ambiente (PostgreSQL + Gerador de Dados) | • `docker compose up` funciona.<br>• Banco populado com +500k vendas. | P0 |
| Qualidade Técnica | T02 | [Técnico] Configurar Camada Analítica (Cube.js) e Frontend (Next.js) | • Camada analítica conectada ao PostgreSQL.<br>• Frontend conectado à API (Vertical Slice).<br>• Decisão arquitetural documentada. | P0 |
| Qualidade Técnica | T03 | [Técnico] Implementar testes automatizados para as métricas. | • Cobertura +80% | P2 |
| Qualidade Técnica | T04 | [Técnico] Fazer o deploy funcional em cloud (ex: Vercel, Railway). | • Deploy funcionando. | P2 |
| Qualidade Técnica | T05 | [Técnico] Implementar **Pré-Agregações** no Cube.js para otimizar a performance. | • Bloco `preAggregations` criado no `sales.js`.<br>• Performance melhorada de +2s para \< 500ms. | P0 |
| UI/UX (Polimento) | T06 | [Técnico] Refatorar todas as telas para usar **Shadcn/UI** e **Tailwind**. | • `npm install shadcn-ui` executado.<br>• Componentes (`<Card>`, `<Table>`, `<Select>`, etc.) implementados em todas as telas. | P1 |
| UI/UX (Polimento) | T07 | [Técnico] Criar **Navegação Global** (Sidebar) e unificar os filtros. | • `Sidebar` criada.<br>• `GlobalFilters` e `FiltersProvider` (Context) criados e implementados no `layout.tsx`.<br>• Páginas filhas (Home, etc.) limpas e a usar o contexto global. | P1 |
| UI/UX (Polimento) | T08 | [Técnico] Tornar a UI **Mobile-Friendly** (Responsiva). | • (Implementação pendente)<br>• (Ex: Fazer a Sidebar colapsar, ajustar os grids de KPIs). | P2 |
